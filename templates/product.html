{% extends 'base.html' %}
{% block title %}Shop &mdash; Free Website Template, Free HTML5 Template by gettemplates.co{% endblock %}
{% block body %}
{% block header %}
<header id="fh5co-header" class="fh5co-cover fh5co-cover-sm" role="banner" style="background-image:url(/static/images/img_bg_2.jpg);">
	<div class="overlay"></div>
	<div class="container">
		<div class="row">
			<div class="col-md-8 col-md-offset-2 text-center">
				<div class="display-t">
					<div class="display-tc animate-box" data-animate-effect="fadeIn">
						<h1>{% block headername %}Product{% endblock %}</h1>
						<h2>E-Commerce Website templates by <a href="https://www.linkedin.com/in/gabriel-johnson-bb4689235/" target="_blank">Gabriel Johnson A.K.A BTL^YONG </a></h2>
					</div>
				</div>
			</div>
		</div>
	</div>
</header>
{% endblock %}
	<div id="fh5co-product">
		<div class="container">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<span>Cool Stuff</span>
					<h2>Products.</h2>
					<p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus alias autem provident. Odit ab aliquam dolor eius.</p>
				</div>
			</div>
			<div class="row">
				{% for product in products %}
				<div class="col-md-4 text-center animate-box">
					<div class="product">
						<div class="product-grid" style="background-image: url(static/images/{{ product.image1 }});">
							<div class="inner">
								<p>
									<a href="#" class="add-to-cart-link" data-product-id="{{ product.id }}"><i class="icon-shopping-cart"></i></a>
									<a href="{{url_for('product_details', id=product.id)}}" class="icon"><i class="icon-eye"></i></a>
								</p>
							</div>
						</div>
						<div class="desc">
							<h3><a href="{{url_for('product_details', id=product.id)}}">{{ product.name }}</a></h3>
							<span class="price">${{ product.price }}</span>
						</div>
					</div>
				</div>
				{% endfor %}
			</div>
		</div>
	</div>


	{% block scripts %}
	<!-- jQuery -->
	<script src="{{ url_for('static', filename='js/jquery.min.js')}}"></script>
	<!-- jQuery Easing -->
	<script src="{{ url_for('static', filename='js/jquery.easing.1.3.js')}}"></script>
	<!-- Bootstrap -->
	<script src="{{ url_for('static', filename='js/bootstrap.min.js')}}"></script>
	<!-- Waypoints -->
	<script src="{{ url_for('static', filename='js/jquery.waypoints.min.js')}}"></script>
	<!-- Carousel -->
	<script src="{{ url_for('static', filename='js/owl.carousel.min.js')}}"></script>
	<!-- countTo -->
	<script src="{{ url_for('static', filename='js/jquery.countTo.js')}}"></script>
	<!-- Flexslider -->
	<script src="{{ url_for('static', filename='js/jquery.flexslider-min.js')}}"></script>

	<!-- Main -->
	<script src="{{ url_for('static', filename='js/main.js')}}"></script>
	<script>
		// Attach a click event handler to the "Add to Cart" links
		$(document).on('click', '.add-to-cart-link', function(e) {
			e.preventDefault(); // Prevent the default link behavior
			
			const productId = $(this).data('product-id'); // Get the product ID from data attribute
	
			// Send an AJAX request to add the product to the cart
			$.ajax({
				url: '/add_to_cart',
				method: 'POST',
				contentType: 'application/json',
				data: JSON.stringify({ product_id: productId }),
				success: function(response) {
					// Handle the success response if needed
					console.log(response);
				},
				error: function(error) {
					// Handle the error response if needed
					console.error('Error adding to cart:', error);
				}
			});
		});
	
		// Fetch the cart count from the API and update the HTML
		fetch('/get_cart_count')
			.then(response => response.json())
			.then(data => {
				console.log('Cart count response:', data);
				const cartCountElement = document.getElementById('cart-count');
				cartCountElement.textContent = data.cart_count;
			})
			.catch(error => {
				console.error('Error fetching cart count:', error);
			});
	</script>
	
	{% endblock scripts %}


{% endblock body %}